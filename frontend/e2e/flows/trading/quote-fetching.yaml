appId: com.nicolasmartin.dankfolio
env:
  LOAD_DEBUG_WALLET: "true"
  E2E_MOCKING_ENABLED: "true"
---
# TradeScreen: Quote Fetching Test
# Tests: handles quote fetching and UI updates on amount change
# Matches Jest test case from TradeScreen.test.tsx

- launchApp
- assertVisible: 
    text: "Portfolio"
    timeout: 10000

# Navigate to Trade screen
- tapOn: "Trade"
- assertVisible:
    text: "Swap"
    timeout: 5000

# Set up trade pair (SOL to USDC)
- tapOn:
    id: "from-token-selector"
- tapOn:
    text: "SOL"
- tapOn:
    id: "to-token-selector"
- tapOn:
    text: "USDC"

# Test amount input and quote fetching
- tapOn:
    id: "amount-input"
- inputText: "1"

# Wait for quote to load
- wait: 2000

# Test that quote information appears
- assertVisible:
    text: "150.5"  # Expected amount out from mock
    timeout: 5000

# Test exchange rate display
- assertVisible:
    text: "15.05"  # Exchange rate from mock
    timeout: 3000

# Test fee information
- assertVisible:
    text: "0.1"  # Fee from mock
    timeout: 3000

# Test price impact
- assertVisible:
    text: "0.01"  # Price impact from mock
    timeout: 3000

# Test updating amount triggers new quote
- tapOn:
    id: "amount-input"
- clearText
- inputText: "2"

# Wait for new quote
- wait: 2000

# Verify quote updates (amounts should roughly double)
- assertVisible:
    text: "301"  # Approximately double the previous amount
    timeout: 5000

# Test decimal input
- tapOn:
    id: "amount-input"
- clearText
- inputText: "0.5"

# Wait for quote
- wait: 2000

# Verify quote for decimal amount
- assertVisible:
    text: "75"  # Approximately half the original amount
    timeout: 5000 