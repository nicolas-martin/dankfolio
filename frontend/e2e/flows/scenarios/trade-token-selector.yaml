appId: com.nicolasmartin.dankfolio
env:
    jupSymbol: "jup"
    solSymbol: "sol"
    dankSymbol: "dank"
    usdcSymbol: "usdc"
---
- runFlow: ../common/app-setup.yaml

# Navigate to trade screen via trending coin
- tapOn:
      id: "trending-coin-card-jup.*"
- tapOn:
      id: "trade-button.*"

# Test 1: Initial SOL -> JUP setup with amount validation
- runFlow:
      file: ../components/trade-token-selector.yaml
      env:
          FROM_SYMBOL: ${solSymbol}
          FROM_AMOUNT: "0"
          FROM_BALANCE: "2.5"
          TO_SYMBOL: ${jupSymbol}
          TO_AMOUNT: "0"
          TO_BALANCE: "0"

# Test 2: Change TO token to DANK and validate with amounts
- tapOn:
      id: "to-token-selector-jup.*"
- tapOn:
      id: "search-result-dank.*"

- tapOn:
      id: "from-token-selector-amount-input"
- inputText: "1"
- waitForAnimationToEnd
- runFlow:
      file: ../components/trade-token-selector.yaml
      env:
          FROM_SYMBOL: ${solSymbol}
          FROM_AMOUNT: "1"
          FROM_BALANCE: "2.5"
          TO_SYMBOL: ${dankSymbol}
          TO_AMOUNT: "0.95"
          TO_BALANCE: "5000000"

# HACK: SAD
# - tapOn:
#       id: "swap-coins-button"
- tapOn:
      point: "50%,48%"

- runFlow:
      file: ../components/trade-token-selector.yaml
      env:
          FROM_SYMBOL: ${dankSymbol}
          FROM_AMOUNT: "0.95"
          FROM_BALANCE: "5000000"
          TO_SYMBOL: ${solSymbol}
          TO_AMOUNT: "1"
          TO_BALANCE: "2.5"

# Test 4: Change FROM token to USDC and validate with amounts
- tapOn:
      id: "from-token-selector-dank.*"
- tapOn:
      id: "search-result-usdc.*"
- runFlow:
      file: ../components/trade-token-selector.yaml
      env:
          FROM_SYMBOL: ${usdcSymbol}
          FROM_AMOUNT: "0"
          FROM_BALANCE: "1000"
          TO_SYMBOL: ${solSymbol}
          TO_AMOUNT: "0"
          TO_BALANCE: "2.5"

- tapOn:
      id: "amount-percentage-text-50"
- runFlow:
      file: ../components/trade-token-selector.yaml
      env:
          FROM_SYMBOL: ${usdcSymbol}
          FROM_AMOUNT: "500"
          FROM_BALANCE: "1000"
          TO_SYMBOL: ${solSymbol}
          TO_AMOUNT: "0"
          TO_BALANCE: "2.5"
