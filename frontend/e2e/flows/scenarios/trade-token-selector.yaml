appId: com.nicolasmartin.dankfolio
env:
    jupSymbol: "JUP"
    solSymbol: "SOL"
    dankSymbol: "DANK"
    usdcSymbol: "USDC"
---
- runFlow: ../common/app-setup.yaml

- tapOn:
      id: "trending-coin-card-JUP.*"
- tapOn:
      id: "trade-button"

# Test initial SOL -> JUP setup
- runFlow:
    file: ../components/trade-token-selector.yaml
    env:
      FROM_SYMBOL: ${solSymbol}
      TO_SYMBOL: ${jupSymbol}

# Test changing TO token to DANK
- tapOn:
      id: "to-token-selector-JUP.*"
- tapOn:
      id: "search-result-DANK.*"

# Test SOL -> DANK setup
- runFlow:
    file: ../components/trade-token-selector.yaml
    env:
      FROM_SYMBOL: ${solSymbol}
      TO_SYMBOL: ${dankSymbol}

# Test swapping tokens
- tapOn:
      id: swap-coins-button

# Test DANK -> SOL setup after swap
- runFlow:
    file: ../components/trade-token-selector.yaml
    env:
      FROM_SYMBOL: ${dankSymbol}
      TO_SYMBOL: ${solSymbol}

# Test changing FROM token to USDC
- tapOn:
      id: "from-token-selector-DANK.*"
- tapOn:
      id: "search-result-USDC.*"

# Test USDC -> SOL setup
- runFlow:
    file: ../components/trade-token-selector.yaml
    env:
      FROM_SYMBOL: ${usdcSymbol}
      TO_SYMBOL: ${solSymbol}

# Test final swap back to SOL -> USDC
- tapOn:
      id: swap-coins-button

# Test SOL -> USDC with amount validation
- runFlow:
    file: ../components/trade-token-selector.yaml
    env:
      FROM_SYMBOL: ${solSymbol}
      TO_SYMBOL: ${usdcSymbol}
      EXPECTED_FROM_AMOUNT: "2.5"

# Test percentage buttons using the parameterized component
- runFlow:
    file: ../components/trade-token-selector.yaml
    env:
      FROM_SYMBOL: ${solSymbol}
      TO_SYMBOL: ${usdcSymbol}
      PERCENTAGE_TO_PRESS: "50"
      EXPECTED_AMOUNT_AFTER_PERCENTAGE: "1.25"

# Test other values are still visible
- assertVisible: "0.95"
- assertVisible: "100"
