appId: com.dankfolio.app
env:
    # Values from CAPTURED_TRANSACTION_DATA in mockData.ts
    testAmount: "1.65973075" # Actual amount from captured transaction
    testRecipientAddress: "6hbS1d1JRRta3GtJC7XNo16gg3PTb41QJVzy6kWsZnav" # TO_ADDRESS from captured data
    solMint: "So11111111111111111111111111111111111111112" # Standard SOL mint
    capturedTokenMint: "CniPCE4b3s8gSUPhUiyMjXnytrEqUrMfSsnbBjLCpump" # TOKEN_MINT from captured data
    largeAmount: "99" # For testing insufficient balance
    smallTestAmount: "0.000000001" # For testing small amounts
---
# Test 1: Setup app
- runFlow: ../common/app-setup.yaml

# Test 2: Navigate to Profile screen using coordinates (bottom navigation)
- tapOn:
      point: "85%,95%"
- waitForAnimationToEnd

# Test 3: Verify Profile screen is visible
- assertVisible:
      id: "profile-screen"

# Test 4: Verify Send button is visible and tap it
- assertVisible:
      id: "send-tokens-button"
- tapOn:
      id: "send-tokens-button"

# Test 5: Verify Send screen loads
- assertVisible:
      text: "To"

# Test 6: Test amount percentage buttons (25%, 50%, 75%, 100%)
- assertVisible:
      id: "amount-percentage-button-25"
- assertVisible:
      id: "amount-percentage-button-50"
- assertVisible:
      id: "amount-percentage-button-75"
- assertVisible:
      id: "amount-percentage-button-100"

# Test 7: Test recipient address input
- tapOn:
      id: "recipient-address-input"
- eraseText
- inputText: "${testRecipientAddress}"
- hideKeyboard

# Test 8: Test invalid address validation
- tapOn:
      id: "recipient-address-input"
- eraseText
- inputText: "invalid-address"
- hideKeyboard
- waitForAnimationToEnd
# Tap outside input field to ensure keyboard is dismissed
- tapOn:
      point: "50%,30%"
- waitForAnimationToEnd
- tapOn:
      id: "send-button"
- assertVisible:
      id: "validation-error-text"
- assertVisible:
      text: "Invalid Solana address"

# Test 9: Test insufficient balance validation with extremely large amount
- tapOn:
      id: "recipient-address-input"
- eraseText
- inputText: "${testRecipientAddress}"
- hideKeyboard
- waitForAnimationToEnd
- tapOn:
      id: "token-selector-amount-input"
- eraseText
- waitForAnimationToEnd
- inputText: "${largeAmount}"
- hideKeyboard
- waitForAnimationToEnd
# Tap outside input field to ensure keyboard is dismissed
- tapOn:
      point: "50%,30%"
- waitForAnimationToEnd
- tapOn:
      id: "send-button"
- assertVisible:
      id: "validation-error-text"
- assertVisible:
      text: "Insufficient balance.*"

- tapOn:
      id: "amount-percentage-button-100"
- assertVisible:
      id: "send-button"
- tapOn:
      id: "send-button"
- waitForAnimationToEnd
- assertVisible:
      id: "verification-continue-button"
- tapOn:
      id: "verification-continue-button"
- waitForAnimationToEnd
- tapOn:
      id: "confirm-send-button"
- assertNotVisible:
      id: "validation-error-text"
- assertVisible:
      id: trade-status-modal
- tapOn:
      id: trade-status-action-button
- waitForAnimationToEnd
- assertNotVisible:
      id: trade-status-modal
# After Done button, should navigate back to Profile screen with single transition
